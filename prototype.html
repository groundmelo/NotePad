<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NotePadÈ´ò‰øùÁúüÂéüÂûã</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            transition: all 0.3s ease;
        }

        body.dark-theme {
            background-color: #121212;
            color: #e0e0e0;
        }

        /* ‰∏ªÂÆπÂô® */
        .app-container {
            max-width: 480px;
            margin: 0 auto;
            height: 100vh;
            background-color: #fff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        body.dark-theme .app-container {
            background-color: #1e1e1e;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        /* È°µÈù¢ÂÆπÂô® */
        .page {
            display: none;
            height: 100%;
            flex-direction: column;
        }

        .page.active {
            display: flex;
        }

        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .header {
            background-color: #6200ee;
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        body.dark-theme .header {
            background-color: #3700b3;
        }

        .header h1 {
            font-size: 20px;
            font-weight: 500;
        }

        .header-actions {
            display: flex;
            gap: 16px;
        }

        .icon-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }

        .icon-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* ÊêúÁ¥¢Ê†è */
        .search-bar {
            padding: 16px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #e0e0e0;
        }

        body.dark-theme .search-bar {
            background-color: #2c2c2c;
            border-bottom-color: #3e3e3e;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            font-size: 16px;
            background-color: white;
            outline: none;
            transition: all 0.2s ease;
        }

        body.dark-theme .search-input {
            background-color: #3e3e3e;
            border-color: #555;
            color: #e0e0e0;
        }

        .search-input:focus {
            border-color: #6200ee;
            box-shadow: 0 0 0 2px rgba(98, 0, 238, 0.2);
        }

        /* Á¨îËÆ∞ÂàóË°® */
        .notes-list {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .note-item {
            background-color: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        body.dark-theme .note-item {
            background-color: #2c2c2c;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .note-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        body.dark-theme .note-item:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .note-title {
            font-size: 18px;
            font-weight: 500;
            margin-right: 8px;
        }

        .note-title.completed, .note-preview.completed {
            text-decoration: line-through;
            color: #999;
        }

        body.dark-theme .note-title.completed, 
        body.dark-theme .note-preview.completed {
            color: #666;
        }

        .note-category {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
            color: white;
        }

        .note-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .note-timestamp {
            font-size: 12px;
            color: #666;
        }

        body.dark-theme .note-timestamp {
            color: #aaa;
        }

        .note-preview {
            font-size: 14px;
            color: #666;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        body.dark-theme .note-preview {
            color: #aaa;
        }

        /* ÂæÖÂäû‰∫ãÈ°πÊ†∑Âºè */
        .todo-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            cursor: pointer;
        }

        .todo-section {
            display: flex;
            align-items: flex-start;
        }

        .todo-content {
            flex: 1;
        }

        /* ÂæÖÂäûÁä∂ÊÄÅÂàáÊç¢ */
        .todo-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #e0e0e0;
        }

        body.dark-theme .todo-toggle {
            background-color: #2c2c2c;
            border-bottom-color: #3e3e3e;
        }

        .todo-toggle label {
            font-weight: 500;
        }

        body.dark-theme .todo-toggle label {
            color: #e0e0e0;
        }

        /* ÊµÆÂä®Êìç‰ΩúÊåâÈíÆ */
        .fab {
            position: absolute;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: #6200ee;
            color: white;
            border: none;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
        }

        body.dark-theme .fab {
            background-color: #3700b3;
        }

        .fab:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        /* Á¨îËÆ∞ÁºñËæëÈ°µÈù¢ */
        .note-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 16px;
        }

        .editor-title {
            width: 100%;
            border: none;
            outline: none;
            font-size: 24px;
            font-weight: 500;
            padding: 8px 0;
            margin-bottom: 16px;
            background: transparent;
        }

        body.dark-theme .editor-title {
            color: #e0e0e0;
        }

        .editor-content {
            flex: 1;
            width: 100%;
            border: none;
            outline: none;
            font-size: 16px;
            line-height: 1.5;
            resize: none;
            background: transparent;
        }

        body.dark-theme .editor-content {
            color: #e0e0e0;
        }

        /* ÂàÜÁ±ªÈÄâÊã©Âô® */
        .category-selector {
            padding: 16px;
            background-color: #f5f5f5;
            border-bottom: 1px solid #e0e0e0;
        }

        body.dark-theme .category-selector {
            background-color: #2c2c2c;
            border-bottom-color: #3e3e3e;
        }

        .category-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        body.dark-theme .category-selector label {
            color: #e0e0e0;
        }

        .category-dropdown {
            width: 100%;
            padding: 12px;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 16px;
            background-color: white;
            outline: none;
        }

        body.dark-theme .category-dropdown {
            background-color: #3e3e3e;
            border-color: #555;
            color: #e0e0e0;
        }

        /* ÂàÜÁ±ªÁÆ°ÁêÜÈ°µÈù¢ */
        .categories-list {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }

        .category-item {
            background-color: white;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        body.dark-theme .category-item {
            background-color: #2c2c2c;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .category-info {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .category-color {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 2px solid #e0e0e0;
        }

        .category-name {
            font-size: 16px;
            font-weight: 500;
        }

        .category-actions {
            display: flex;
            gap: 8px;
        }

        .delete-btn {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        /* ‰æßÊªëËèúÂçï */
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100vh;
            background-color: white;
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease;
            z-index: 1000;
        }

        body.dark-theme .sidebar {
            background-color: #1e1e1e;
        }

        .sidebar.open {
            left: 0;
        }

        .sidebar-header {
            background-color: #6200ee;
            color: white;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        body.dark-theme .sidebar-header {
            background-color: #3700b3;
        }

        .sidebar-content {
            padding: 16px;
        }

        .sidebar-section {
            margin-bottom: 24px;
        }

        .sidebar-section h3 {
            font-size: 14px;
            font-weight: 500;
            color: #666;
            text-transform: uppercase;
            margin-bottom: 12px;
        }

        body.dark-theme .sidebar-section h3 {
            color: #aaa;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .sidebar-item:hover {
            background-color: #f5f5f5;
        }

        body.dark-theme .sidebar-item:hover {
            background-color: #2c2c2c;
        }

        .sidebar-item.active {
            background-color: rgba(98, 0, 238, 0.1);
            color: #6200ee;
        }

        body.dark-theme .sidebar-item.active {
            background-color: rgba(98, 0, 238, 0.2);
        }

        /* ‰∏ªÈ¢òÂàáÊç¢ÂºÄÂÖ≥ */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #6200ee;
        }

        input:focus + .toggle-slider {
            box-shadow: 0 0 1px #6200ee;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        /* ÈÅÆÁΩ©Â±Ç */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none;
        }

        .overlay.show {
            display: block;
        }

        /* Âä†ËΩΩÂä®Áîª */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            font-size: 16px;
            color: #666;
        }

        body.dark-theme .loading {
            color: #aaa;
        }

        /* Á©∫Áä∂ÊÄÅ */
        .empty-state {
            text-align: center;
            padding: 48px 16px;
            color: #666;
        }

        body.dark-theme .empty-state {
            color: #aaa;
        }

        .empty-state i {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 480px) {
            .app-container {
                max-width: 100%;
                height: 100vh;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ÈÅÆÁΩ©Â±Ç -->
        <div class="overlay" id="overlay"></div>

        <!-- ‰æßÊªëËèúÂçï -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>ËèúÂçï</h2>
                <button class="icon-btn" id="closeSidebar">√ó</button>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h3>ÂàÜÁ±ªÁ≠õÈÄâ</h3>
                    <div class="sidebar-item active" data-category="all">
                        <i>üìù</i>
                        <span>ÂÖ®ÈÉ®Á¨îËÆ∞</span>
                    </div>
                    <div class="sidebar-item" data-category="Â∑•‰Ωú">
                        <i>üíº</i>
                        <span>Â∑•‰Ωú</span>
                    </div>
                    <div class="sidebar-item" data-category="Â≠¶‰π†">
                        <i>üìö</i>
                        <span>Â≠¶‰π†</span>
                    </div>
                    <div class="sidebar-item" data-category="ÁîüÊ¥ª">
                        <i>üè†</i>
                        <span>ÁîüÊ¥ª</span>
                    </div>
                    <div class="sidebar-item" data-category="ÂÖ∂‰ªñ">
                        <i>üîñ</i>
                        <span>ÂÖ∂‰ªñ</span>
                    </div>
                    <div class="sidebar-item" onclick="showCategoriesPage()">
                        <i>‚öôÔ∏è</i>
                        <span>ÁÆ°ÁêÜÂàÜÁ±ª</span>
                    </div>
                </div>
                <div class="sidebar-section">
                    <h3>ËÆæÁΩÆ</h3>
                    <div class="sidebar-item">
                        <div class="theme-toggle">
                            <span>Ê∑±Ëâ≤‰∏ªÈ¢ò</span>
                            <label class="toggle-switch">
                                <input type="checkbox" id="themeToggle">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Á¨îËÆ∞ÂàóË°®È°µÈù¢ -->
        <div class="page active" id="notesListPage">
            <div class="header">
                <div style="display: flex; align-items: center; gap: 16px;">
                    <button class="icon-btn" id="openSidebar">‚ò∞</button>
                    <h1>Á¨îËÆ∞</h1>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" id="sortBtn">‚áÖ</button>
                    <button class="icon-btn" id="searchBtn">üîç</button>
                </div>
            </div>
            
            <div class="search-bar" id="searchBar" style="display: none;">
                <input type="text" class="search-input" placeholder="ÊêúÁ¥¢Á¨îËÆ∞..." id="searchInput">
            </div>
            
            <div class="notes-list" id="notesList">
                <!-- Á¨îËÆ∞ÂàóË°®Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
            </div>
            
            <button class="fab" id="addNoteBtn">+</button>
        </div>

        <!-- Á¨îËÆ∞ÁºñËæëÈ°µÈù¢ -->
        <div class="page" id="noteEditorPage">
            <div class="header">
                <button class="icon-btn" id="backToNotesBtn">‚Üê</button>
                <h1>ÁºñËæëÁ¨îËÆ∞</h1>
                <button class="icon-btn" id="saveNoteBtn">üíæ</button>
            </div>
            
            <div class="category-selector">
                <label for="noteCategory">ÂàÜÁ±ª</label>
                <select class="category-dropdown" id="noteCategory">
                    <option value="Â∑•‰Ωú">Â∑•‰Ωú</option>
                    <option value="Â≠¶‰π†">Â≠¶‰π†</option>
                    <option value="ÁîüÊ¥ª">ÁîüÊ¥ª</option>
                    <option value="ÂÖ∂‰ªñ">ÂÖ∂‰ªñ</option>
                </select>
            </div>
            
            <div class="todo-toggle">
                <label for="isTodo">ÂæÖÂäû‰∫ãÈ°π</label>
                <label class="toggle-switch">
                    <input type="checkbox" id="isTodo">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="note-editor">
                <input type="text" class="editor-title" placeholder="ËæìÂÖ•Ê†áÈ¢ò..." id="noteTitle">
                <textarea class="editor-content" placeholder="ËæìÂÖ•ÂÜÖÂÆπ..." id="noteContent"></textarea>
            </div>
        </div>

        <!-- ÂàÜÁ±ªÁÆ°ÁêÜÈ°µÈù¢ -->
        <div class="page" id="categoriesPage">
            <div class="header">
                <button class="icon-btn" id="backToNotesFromCategoriesBtn">‚Üê</button>
                <h1>ÂàÜÁ±ªÁÆ°ÁêÜ</h1>
                <button class="icon-btn" id="addCategoryBtn">+</button>
            </div>
            
            <div class="categories-list" id="categoriesList">
                <!-- ÂàÜÁ±ªÂàóË°®Â∞ÜÈÄöËøáJavaScriptÂä®ÊÄÅÁîüÊàê -->
            </div>
        </div>
    </div>

    <script>
        // Ê®°ÊãüÁ¨îËÆ∞Êï∞ÊçÆ
        let notes = [
            {
                id: 1,
                title: "‰ºöËÆÆËÆ∞ÂΩï",
                content: "‰ªäÂ§©ÁöÑ‰ºöËÆÆËÆ®ËÆ∫‰∫ÜÈ°πÁõÆÁöÑËøõÂ∫¶Âíå‰∏ã‰∏ÄÊ≠•ËÆ°ÂàíÔºåÈúÄË¶ÅÂÆåÊàê‰ª•‰∏ã‰ªªÂä°Ôºö1. ÂÆåÊàêÈúÄÊ±ÇÊñáÊ°£Ôºõ2. ËøõË°åÊäÄÊúØÈÄâÂûãÔºõ3. Âà∂ÂÆöÂºÄÂèëËÆ°Âàí„ÄÇ",
                category: "Â∑•‰Ωú",
                categoryColor: "#FF5722",
                timestamp: "2023-10-15 14:30:00",
                createDate: "2023-10-15 14:30:00",
                modifiedDate: "2023-10-15 14:30:00",
                todoStatus: 0 // ÊôÆÈÄöÁ¨îËÆ∞
            },
            {
                id: 2,
                title: "Â≠¶‰π†ËÆ°Âàí",
                content: "Êú¨Âë®ÈúÄË¶ÅÂ≠¶‰π†AndroidÂºÄÂèëÁöÑ‰ª•‰∏ãÂÜÖÂÆπÔºö1. RecyclerViewÁöÑÈ´òÁ∫ßÁî®Ê≥ïÔºõ2. RoomÊï∞ÊçÆÂ∫ìÔºõ3. Jetpack ComposeÂü∫Á°Ä„ÄÇ",
                category: "Â≠¶‰π†",
                categoryColor: "#4CAF50",
                timestamp: "2023-10-14 09:15:00",
                createDate: "2023-10-14 09:15:00",
                modifiedDate: "2023-10-14 09:15:00",
                todoStatus: 1 // ÂæÖÂäû‰∫ãÈ°πÔºàÊú™ÂÆåÊàêÔºâ
            },
            {
                id: 3,
                title: "Ë¥≠Áâ©Ê∏ÖÂçï",
                content: "ÊòéÂ§©ÈúÄË¶ÅË¥≠‰π∞ÁöÑÁâ©ÂìÅÔºö1. ÁâõÂ•∂Ôºõ2. È∏°ËõãÔºõ3. Ëî¨ËèúÔºõ4. Ê∞¥Êûú„ÄÇ",
                category: "ÁîüÊ¥ª",
                categoryColor: "#2196F3",
                timestamp: "2023-10-13 18:45:00",
                createDate: "2023-10-13 18:45:00",
                modifiedDate: "2023-10-13 18:45:00",
                todoStatus: 1 // ÂæÖÂäû‰∫ãÈ°πÔºàÊú™ÂÆåÊàêÔºâ
            },
            {
                id: 4,
                title: "ÁÅµÊÑüËÆ∞ÂΩï",
                content: "Á™ÅÁÑ∂ÊÉ≥Âà∞‰∏Ä‰∏™Â•Ω‰∏ªÊÑèÔºåÂèØ‰ª•ÂºÄÂèë‰∏Ä‰∏™Âü∫‰∫éAIÁöÑÁ¨îËÆ∞Â∫îÁî®ÔºåËÉΩÂ§üËá™Âä®ÂàÜÁ±ªÂíåÊÄªÁªìÁ¨îËÆ∞ÂÜÖÂÆπ„ÄÇ",
                category: "ÂÖ∂‰ªñ",
                categoryColor: "#9C27B0",
                timestamp: "2023-10-12 22:10:00",
                createDate: "2023-10-12 22:10:00",
                modifiedDate: "2023-10-12 22:10:00",
                todoStatus: 0 // ÊôÆÈÄöÁ¨îËÆ∞
            }
        ];

        // Ê®°ÊãüÂàÜÁ±ªÊï∞ÊçÆ
        let categories = [
            { id: 1, name: "Â∑•‰Ωú", color: "#FF5722" },
            { id: 2, name: "Â≠¶‰π†", color: "#4CAF50" },
            { id: 3, name: "ÁîüÊ¥ª", color: "#2196F3" },
            { id: 4, name: "ÂÖ∂‰ªñ", color: "#9C27B0" }
        ];

        // ÂΩìÂâçÈÄâ‰∏≠ÁöÑÂàÜÁ±ª
        let currentCategory = "all";
        // ÂΩìÂâçÊêúÁ¥¢ÂÖ≥ÈîÆËØç
        let currentSearchKeyword = "";
        // ÂΩìÂâçÊéíÂ∫èÊñπÂºè
        let currentSort = "modifiedDate DESC";

        // DOMÂÖÉÁ¥†
        const notesList = document.getElementById('notesList');
        const searchBar = document.getElementById('searchBar');
        const searchInput = document.getElementById('searchInput');
        const addNoteBtn = document.getElementById('addNoteBtn');
        const backToNotesBtn = document.getElementById('backToNotesBtn');
        const saveNoteBtn = document.getElementById('saveNoteBtn');
        const noteTitle = document.getElementById('noteTitle');
        const noteContent = document.getElementById('noteContent');
        const noteCategory = document.getElementById('noteCategory');
        const openSidebar = document.getElementById('openSidebar');
        const closeSidebar = document.getElementById('closeSidebar');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const searchBtn = document.getElementById('searchBtn');
        const sortBtn = document.getElementById('sortBtn');
        const themeToggle = document.getElementById('themeToggle');
        const notesListPage = document.getElementById('notesListPage');
        const noteEditorPage = document.getElementById('noteEditorPage');
        const categoriesPage = document.getElementById('categoriesPage');
        const backToNotesFromCategoriesBtn = document.getElementById('backToNotesFromCategoriesBtn');
        const categoriesList = document.getElementById('categoriesList');
        const addCategoryBtn = document.getElementById('addCategoryBtn');

        // ÂàùÂßãÂåñ
        function init() {
            renderNotes();
            renderCategories();
            bindEvents();
        }

        // ÁªëÂÆö‰∫ã‰ª∂
        function bindEvents() {
            // ÊêúÁ¥¢Áõ∏ÂÖ≥‰∫ã‰ª∂
            searchBtn.addEventListener('click', toggleSearch);
            searchInput.addEventListener('input', handleSearch);

            // Á¨îËÆ∞ÁºñËæëÁõ∏ÂÖ≥‰∫ã‰ª∂
            addNoteBtn.addEventListener('click', showNoteEditor);
            backToNotesBtn.addEventListener('click', showNotesList);
            saveNoteBtn.addEventListener('click', saveNote);
            backToNotesFromCategoriesBtn.addEventListener('click', showNotesList);

            // ‰æßÊªëËèúÂçïÁõ∏ÂÖ≥‰∫ã‰ª∂
            openSidebar.addEventListener('click', openSidebarMenu);
            closeSidebar.addEventListener('click', closeSidebarMenu);
            overlay.addEventListener('click', closeSidebarMenu);

            // ÂàÜÁ±ªÁ≠õÈÄâ‰∫ã‰ª∂
            document.querySelectorAll('.sidebar-item[data-category]').forEach(item => {
                item.addEventListener('click', handleCategoryFilter);
            });

            // ‰∏ªÈ¢òÂàáÊç¢‰∫ã‰ª∂
            themeToggle.addEventListener('change', toggleTheme);

            // ÊéíÂ∫è‰∫ã‰ª∂
            sortBtn.addEventListener('click', showSortOptions);
        }

        // Ê∏≤ÊüìÁ¨îËÆ∞ÂàóË°®
        function renderNotes() {
            // Á≠õÈÄâÂíåÊéíÂ∫èÁ¨îËÆ∞
            let filteredNotes = notes.filter(note => {
                const matchesCategory = currentCategory === 'all' || note.category === currentCategory;
                const matchesSearch = note.title.toLowerCase().includes(currentSearchKeyword.toLowerCase()) ||
                                     note.content.toLowerCase().includes(currentSearchKeyword.toLowerCase());
                return matchesCategory && matchesSearch;
            });

            // ÊéíÂ∫è
            filteredNotes.sort((a, b) => {
                if (currentSort === 'modifiedDate DESC') {
                    return new Date(b.modifiedDate) - new Date(a.modifiedDate);
                } else if (currentSort === 'modifiedDate ASC') {
                    return new Date(a.modifiedDate) - new Date(b.modifiedDate);
                } else if (currentSort === 'title ASC') {
                    return a.title.localeCompare(b.title);
                } else if (currentSort === 'title DESC') {
                    return b.title.localeCompare(a.title);
                } else if (currentSort === 'todoStatus') {
                    // ÊåâÂæÖÂäûÁä∂ÊÄÅÊéíÂ∫èÔºöÊú™ÂÆåÊàêÂæÖÂäû > ÊôÆÈÄöÁ¨îËÆ∞ > Â∑≤ÂÆåÊàêÂæÖÂäû
                    if (a.todoStatus === 1 && b.todoStatus !== 1) return -1;
                    if (a.todoStatus !== 1 && b.todoStatus === 1) return 1;
                    if (a.todoStatus === 0 && b.todoStatus === 2) return -1;
                    if (a.todoStatus === 2 && b.todoStatus === 0) return 1;
                    return 0;
                }
                return 0;
            });

            if (filteredNotes.length === 0) {
                notesList.innerHTML = `
                    <div class="empty-state">
                        <i>üì≠</i>
                        <h3>Ê≤°ÊúâÊâæÂà∞Á¨îËÆ∞</h3>
                        <p>Â∞ùËØïË∞ÉÊï¥ÊêúÁ¥¢Êù°‰ª∂ÊàñÂàÜÁ±ªÁ≠õÈÄâ</p>
                    </div>
                `;
                return;
            }

            notesList.innerHTML = filteredNotes.map(note => {
                const isTodo = note.todoStatus === 1 || note.todoStatus === 2;
                const isCompleted = note.todoStatus === 2;
                return `
                <div class="note-item">
                    <div class="todo-section">
                        ${isTodo ? `
                            <input type="checkbox" class="todo-checkbox" 
                                   ${isCompleted ? 'checked' : ''} 
                                   onclick="toggleTodoStatus(${note.id}, event)">
                        ` : ''}
                        <div class="todo-content" onclick="editNote(${note.id})">
                            <div class="note-header">
                                <h3 class="note-title ${isCompleted ? 'completed' : ''}">${note.title}</h3>
                                <span class="note-category" style="background-color: ${note.categoryColor}">${note.category}</span>
                            </div>
                            <div class="note-meta">
                                <span class="note-timestamp">${note.timestamp}</span>
                            </div>
                            <div class="note-preview ${isCompleted ? 'completed' : ''}">${note.content}</div>
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        // Ê∏≤ÊüìÂàÜÁ±ªÂàóË°®
        function renderCategories() {
            categoriesList.innerHTML = categories.map(category => `
                <div class="category-item">
                    <div class="category-info">
                        <div class="category-color" style="background-color: ${category.color}"></div>
                        <span class="category-name">${category.name}</span>
                    </div>
                    <div class="category-actions">
                        <button class="icon-btn" onclick="editCategory(${category.id})">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteCategory(${category.id})">Âà†Èô§</button>
                    </div>
                </div>
            `).join('');
        }

        // ÂàáÊç¢ÊêúÁ¥¢Ê†èÊòæÁ§∫
        function toggleSearch() {
            searchBar.style.display = searchBar.style.display === 'none' ? 'block' : 'none';
            if (searchBar.style.display === 'block') {
                searchInput.focus();
            }
        }

        // Â§ÑÁêÜÊêúÁ¥¢
        function handleSearch(e) {
            currentSearchKeyword = e.target.value;
            renderNotes();
        }

        // ÊòæÁ§∫Á¨îËÆ∞ÁºñËæëÂô®
        function showNoteEditor() {
            // Ê∏ÖÁ©∫Ë°®Âçï
            noteTitle.value = '';
            noteContent.value = '';
            noteCategory.value = 'Â∑•‰Ωú';
            isTodo.checked = false;
            
            // ÂàáÊç¢È°µÈù¢
            notesListPage.classList.remove('active');
            noteEditorPage.classList.add('active');
        }

        // ÊòæÁ§∫Á¨îËÆ∞ÂàóË°®
        function showNotesList() {
            notesListPage.classList.add('active');
            noteEditorPage.classList.remove('active');
            categoriesPage.classList.remove('active');
        }

        // ÊòæÁ§∫ÂàÜÁ±ªÁÆ°ÁêÜÈ°µÈù¢
        function showCategoriesPage() {
            notesListPage.classList.remove('active');
            categoriesPage.classList.add('active');
            closeSidebarMenu();
        }

        // ÁºñËæëÁ¨îËÆ∞
        function editNote(id) {
            const note = notes.find(n => n.id === id);
            if (note) {
                noteTitle.value = note.title;
                noteContent.value = note.content;
                noteCategory.value = note.category;
                isTodo.checked = note.todoStatus === 1 || note.todoStatus === 2;
                
                notesListPage.classList.remove('active');
                noteEditorPage.classList.add('active');
            }
        }

        // ‰øùÂ≠òÁ¨îËÆ∞
        function saveNote() {
            const title = noteTitle.value.trim();
            const content = noteContent.value.trim();
            const category = noteCategory.value;
            const todoStatus = isTodo.checked ? 1 : 0; // 1: ÂæÖÂäû‰∫ãÈ°πÔºàÊú™ÂÆåÊàêÔºâÔºå0: ÊôÆÈÄöÁ¨îËÆ∞
            
            if (title && content) {
                const timestamp = new Date().toISOString().slice(0, 19).replace('T', ' ');
                const categoryObj = categories.find(c => c.name === category);
                
                const newNote = {
                    id: Date.now(),
                    title,
                    content,
                    category,
                    categoryColor: categoryObj.color,
                    timestamp,
                    createDate: timestamp,
                    modifiedDate: timestamp,
                    todoStatus
                };
                
                notes.push(newNote);
                renderNotes();
                showNotesList();
            }
        }

        // ÂàáÊç¢ÂæÖÂäûÁä∂ÊÄÅ
        function toggleTodoStatus(id, event) {
            // ÈòªÊ≠¢‰∫ã‰ª∂ÂÜíÊ≥°ÔºåÈÅøÂÖçËß¶ÂèëÁºñËæëÁ¨îËÆ∞
            event.stopPropagation();
            
            const note = notes.find(n => n.id === id);
            if (note) {
                if (note.todoStatus === 1) {
                    note.todoStatus = 2; // Ê†áËÆ∞‰∏∫Â∑≤ÂÆåÊàê
                } else if (note.todoStatus === 2) {
                    note.todoStatus = 1; // Ê†áËÆ∞‰∏∫Êú™ÂÆåÊàê
                }
                // Êõ¥Êñ∞Êó∂Èó¥Êà≥
                note.timestamp = new Date().toISOString().slice(0, 19).replace('T', ' ');
                note.modifiedDate = note.timestamp;
                renderNotes();
            }
        }

        // ÊâìÂºÄ‰æßÊªëËèúÂçï
        function openSidebarMenu() {
            sidebar.classList.add('open');
            overlay.classList.add('show');
        }

        // ÂÖ≥Èó≠‰æßÊªëËèúÂçï
        function closeSidebarMenu() {
            sidebar.classList.remove('open');
            overlay.classList.remove('show');
        }

        // Â§ÑÁêÜÂàÜÁ±ªÁ≠õÈÄâ
        function handleCategoryFilter(e) {
            // Êõ¥Êñ∞ÊøÄÊ¥ªÁä∂ÊÄÅ
            document.querySelectorAll('.sidebar-item[data-category]').forEach(item => {
                item.classList.remove('active');
            });
            e.target.closest('.sidebar-item').classList.add('active');
            
            // Â∫îÁî®Á≠õÈÄâ
            currentCategory = e.target.closest('.sidebar-item').dataset.category;
            renderNotes();
            closeSidebarMenu();
        }

        // ‰∏ªÈ¢òÂàáÊç¢
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
        }

        // ÊòæÁ§∫ÊéíÂ∫èÈÄâÈ°π
        function showSortOptions() {
            // ËøôÈáåÂèØ‰ª•ÂÆûÁé∞‰∏Ä‰∏™ÊéíÂ∫èÈÄâÈ°πËèúÂçïÔºå‰∏∫‰∫ÜÁÆÄÂåñÔºåÊàë‰ª¨Áõ¥Êé•ÂàáÊç¢ÊéíÂ∫èÊñπÂºè
            if (currentSort === 'modifiedDate DESC') {
                currentSort = 'modifiedDate ASC';
                alert('Â∑≤ÂàáÊç¢‰∏∫Êåâ‰øÆÊîπÊó∂Èó¥ÂçáÂ∫èÊéíÂ∫è');
            } else if (currentSort === 'modifiedDate ASC') {
                currentSort = 'title ASC';
                alert('Â∑≤ÂàáÊç¢‰∏∫ÊåâÊ†áÈ¢òÂçáÂ∫èÊéíÂ∫è');
            } else if (currentSort === 'title ASC') {
                currentSort = 'title DESC';
                alert('Â∑≤ÂàáÊç¢‰∏∫ÊåâÊ†áÈ¢òÈôçÂ∫èÊéíÂ∫è');
            } else {
                currentSort = 'modifiedDate DESC';
                alert('Â∑≤ÂàáÊç¢‰∏∫Êåâ‰øÆÊîπÊó∂Èó¥ÈôçÂ∫èÊéíÂ∫è');
            }
            renderNotes();
        }

        // ÁºñËæëÂàÜÁ±ª
        function editCategory(id) {
            const category = categories.find(c => c.id === id);
            if (category) {
                const newName = prompt('ËØ∑ËæìÂÖ•Êñ∞ÁöÑÂàÜÁ±ªÂêçÁß∞:', category.name);
                if (newName && newName.trim()) {
                    category.name = newName.trim();
                    renderCategories();
                    renderNotes(); // Êõ¥Êñ∞Á¨îËÆ∞ÂàóË°®‰∏≠ÁöÑÂàÜÁ±ªÊòæÁ§∫
                }
            }
        }

        // Âà†Èô§ÂàÜÁ±ª
        function deleteCategory(id) {
            if (confirm('Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™ÂàÜÁ±ªÂêóÔºü')) {
                categories = categories.filter(c => c.id !== id);
                // Â∞Ü‰ΩøÁî®ËØ•ÂàÜÁ±ªÁöÑÁ¨îËÆ∞ÁßªËá≥"ÂÖ∂‰ªñ"
                notes.forEach(note => {
                    const category = categories.find(c => c.name === note.category);
                    if (!category) {
                        note.category = 'ÂÖ∂‰ªñ';
                        note.categoryColor = categories.find(c => c.name === 'ÂÖ∂‰ªñ').color;
                    }
                });
                renderCategories();
                renderNotes();
            }
        }

        // ÂàùÂßãÂåñÂ∫îÁî®
        init();
    </script>
</body>
</html>